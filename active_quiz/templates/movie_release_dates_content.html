{% load static %}
{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/active_quiz/active_quiz.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/active_quiz/movie_release_dates.css' %}">
{% endblock %}

{% if current_movie %}
    <div class="movie-poster-container">
        <img class="movie-poster" src="{{ current_movie.poster.url }}" alt="{{ current_movie.title }}">
    </div>

    <form id="year-form" method="post" action="{% url 'active_quiz:next_movie_release_date' %}">
        {% csrf_token %}
        <input type="hidden" name="correct_year" value="{{ correct_year }}">
        
        {% if request.user.username == 'david' %}
            <div class="answer-display" id="answer-display" style="display: none;">
                <p class="answer-text">{{ correct_year }}</p>
            </div>
            <button type="button" class="reveal-button" onclick="revealYear()">Reveal Year</button>
            <button type="submit" class="next-button">Next</button>
        {% else %}
            <div class="year-display-box">
                <div id="year-display" class="year-number">2000</div>
                <div class="year-unit">release year</div>
            </div>
            
            <div class="slider-wrapper">
                <div class="slider-track">
                    <span class="slider-min">1950</span>
                    <input type="range" id="year-slider" name="year" min="1950" max="{{ current_year }}" value="2000" oninput="updateYearDisplay(this.value)">
                    <span class="slider-max">{{ current_year }}</span>
                </div>
            </div>
            
            <button type="submit" class="submit-button">Submit</button>
        {% endif %}
    </form>
{% endif %}

<script>
    function updateYearDisplay(value) {
        document.getElementById('year-display').textContent = value;
    }

    function revealYear() {
        const answerDisplay = document.getElementById('answer-display');
        answerDisplay.style.display = 'block';
        setTimeout(() => {
            answerDisplay.style.opacity = '1';
        }, 10);
    }
</script>