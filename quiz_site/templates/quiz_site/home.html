{% extends "base.html" %}

{% load static %}

{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/quiz_site/home.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    {% if not user.is_authenticated %}
    <!-- Login/Signup Banner for Unauthenticated Users -->
    <div class="auth-banner">
        <div class="auth-banner-content">
            <h2>ðŸŽ‰ Welcome to QuizMaster!</h2>
            <p>Please login or sign up to unlock all features and participate in quizzes.</p>
            <div class="auth-banner-buttons">
                <a href="{% url 'account_login' %}" class="btn btn-primary">Login</a>
                <a href="{% url 'account_signup' %}" class="btn btn-success">Sign Up</a>
            </div>
        </div>
    </div>
    {% endif %}
    
    <div class="grid">
        <div class="tab-card">
            <div class="tab-header">
                <button class="tab-button active" data-tab="participant">Participant</button>
                <button class="tab-button{% if not user.is_authenticated %} disabled{% endif %}" data-tab="master" {% if not user.is_authenticated %}disabled{% endif %}>Quiz Master</button>
            </div>
            
            <div class="tab-content" id="participant-content">
                <h3>Join a Quiz</h3>
                <form method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="join_code" class="form-label">Enter Join Code</label>
                        <input type="text" class="form-input input-code" id="join_code" name="join_code" placeholder="ENTER CODE" maxlength="4">
                    </div>
                    <div>
                        <button type="submit" class="btn btn-success">Join Quiz</button>
                    </div>
                </form>
            </div>
            
            <div class="tab-content hidden" id="master-content">
                {% if user.is_authenticated %}
                <h3>Create or Manage a Quiz</h3>
                <form class="new-quiz-form" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="id_quiz_name" class="form-label">Quiz Name</label>
                        <input type="text" class="form-input" id="id_quiz_name" name="quiz_name" required placeholder="Enter quiz name">
                    </div>
                    <div>
                        <button type="submit" class="btn btn-success">Create Quiz</button>
                    </div>
                </form>

                <div class="manage-quizzes-container">
                    <a href="{% url 'manage_quizzes' %}" class="btn btn-secondary">Manage Quizzes</a>
                </div>

                <div class="tab-description">
                    <p>As a Quiz Master, you can create custom quizzes, select categories, 
                    and control the quiz flow. Players will join using the code.</p>
                </div>
                {% else %}
                <div class="auth-message">
                    <h3>ðŸ”’ Authentication Required</h3>
                    <p>You must be logged in to create and manage quizzes.</p>
                    <div class="auth-banner-buttons">
                        <a href="{% url 'account_login' %}" class="btn btn-primary">Login</a>
                        <a href="{% url 'account_signup' %}" class="btn btn-success">Sign Up</a>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="features">
        <div class="features-header">
            <h2 class="title-color">Why Choose QuizMaster?</h2>
        </div>
        <div class="feature-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h4>Quick Setup</h4>
                <p>Create a quiz in minutes with our intuitive interface. Choose from various categories or create your own questions.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h4>Interactive Experience</h4>
                <p>Engage participants with real-time scoring, leaderboards, and interactive question formats.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h4>Mobile Friendly</h4>
                <p>Participants can join using any device with a browser. No app installation required.</p>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Prevent disabled tabs from being clicked
                if (this.disabled || this.classList.contains('disabled')) {
                    return;
                }
                
                const tabName = this.getAttribute('data-tab');
                
                // Update active tab button
                tabButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Show content for active tab
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(`${tabName}-content`).classList.remove('hidden');
            });
        });
    });
</script>
{% endblock %}